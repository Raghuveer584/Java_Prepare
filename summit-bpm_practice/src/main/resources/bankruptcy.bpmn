<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_0umyj91" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="1.16.0">
  <bpmn:process id="bankruptcy" name="Ccreate Bankruptcy" isExecutable="true">
    <bpmn:startEvent id="StartEvent_0ewcpto">
      <bpmn:outgoing>SequenceFlow_1oosc2k</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:serviceTask id="Task_0uo0f7r" name="process bankruptcy creation">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">
              <camunda:script scriptFormat="JavaScript">var adapterUrl = execution.getVariable('adapterUrl'); 
adapterUrl + '/unsecure/bankruptcy/create';</camunda:script>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="Accept">application/json</camunda:entry>
                <camunda:entry key="content-type">application/json</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="JavaScript">var bankRuptRequest=execution.getVariable("bankRuptRequest");   
bankRuptRequest.toString()</camunda:script>
            </camunda:inputParameter>
            <camunda:outputParameter name="bankruptcyId">
              <camunda:script scriptFormat="JavaScript">java.lang.System.out.println(response);
var bankRuptId= S(response).elements().get(0).prop('bankruptcyId').numberValue();
java.lang.System.out.println(bankRuptId);

bankRuptId; 
S(response).elements().get(0).prop('bankruptcyId').numberValue();</camunda:script>
            </camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0zxydd7</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0i1ljya</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_0x7dz3l">
      <bpmn:incoming>SequenceFlow_0i1ljya</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1i63awy</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_10gvnfv</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_0i1ljya" sourceRef="Task_0uo0f7r" targetRef="ExclusiveGateway_0x7dz3l" />
    <bpmn:sequenceFlow id="SequenceFlow_1i63awy" name="Success" sourceRef="ExclusiveGateway_0x7dz3l" targetRef="UserTask_1pr5qfk">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${bankruptcyId  != null}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:userTask id="Task_0lmrup3" name="Manage Bankruptcy">
      <bpmn:incoming>SequenceFlow_0i6dk50</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_1462y2m</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_08wquce</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:endEvent id="EndEvent_1tlv432">
      <bpmn:incoming>SequenceFlow_10gvnfv</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="SequenceFlow_10gvnfv" name="Failed" sourceRef="ExclusiveGateway_0x7dz3l" targetRef="EndEvent_1tlv432">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression">${bankruptcyId  == null}</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:serviceTask id="ServiceTask_Discharge_Bankruptcy" name="discharge bankruptcy" default="SequenceFlow_0pm94hw">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">
              <camunda:script scriptFormat="JavaScript">var adapterUrl = execution.getVariable('adapterUrl'); 
adapterUrl + '/unsecure/bankruptcy/discharge'</camunda:script>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="Accept">application/json</camunda:entry>
                <camunda:entry key="content-type">application/json</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="JavaScript">var bankRuptDischargeRequest=execution.getVariable("bankRuptDischargeRequest");   
bankRuptDischargeRequest.toString()</camunda:script>
            </camunda:inputParameter>
            <camunda:outputParameter name="discharge">
              <camunda:script scriptFormat="JavaScript">java.lang.System.out.println(response);

var dischargeRes = JSON.parse(response);
 var entityRes=dischargeRes.entity;
var discharge= entityRes.discharge;

java.lang.System.out.println(discharge);
discharge;</camunda:script>
            </camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1bq4kwa</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0pm94hw</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:endEvent id="EndEvent_1mc81g0">
      <bpmn:incoming>SequenceFlow_0pm94hw</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_1d5kp5u</bpmn:incoming>
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="SequenceFlow_0pm94hw" sourceRef="ServiceTask_Discharge_Bankruptcy" targetRef="EndEvent_1mc81g0" />
    <bpmn:sequenceFlow id="SequenceFlow_0i6dk50" sourceRef="update_bankruptcy" targetRef="Task_0lmrup3" />
    <bpmn:serviceTask id="update_bankruptcy" name="updateÂ  bankruptcy">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">
              <camunda:script scriptFormat="JavaScript">var adapterUrl = execution.getVariable('adapterUrl'); 
adapterUrl + '/unsecure/bankruptcy/readjust';</camunda:script>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="Accept">application/json</camunda:entry>
                <camunda:entry key="content-type">application/json</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="JavaScript">var bankRuptUpdateRequest=execution.getVariable("bankRuptUpdateRequest");   
bankRuptUpdateRequest.toString()</camunda:script>
            </camunda:inputParameter>
            <camunda:outputParameter name="readjustStatus">
              <camunda:script scriptFormat="JavaScript">java.lang.System.out.println(response);

var adjustRes = JSON.parse(response);
 var entityRes=adjustRes .entity;
var readjustStatus= entityRes.readjustStatus;

java.lang.System.out.println(readjustStatus);
readjustStatus;</camunda:script>
            </camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_1be5nzy</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0i6dk50</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:sequenceFlow id="SequenceFlow_1oosc2k" sourceRef="StartEvent_0ewcpto" targetRef="Task_1x2r80z" />
    <bpmn:scriptTask id="Task_1x2r80z" name="start_task" scriptFormat="JavaScript">
      <bpmn:incoming>SequenceFlow_1oosc2k</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0zxydd7</bpmn:outgoing>
      <bpmn:script>java.lang.System.out.println('bankruptcy start');</bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="SequenceFlow_0zxydd7" sourceRef="Task_1x2r80z" targetRef="Task_0uo0f7r" />
    <bpmn:exclusiveGateway id="ExclusiveGateway_0zrnh1u">
      <bpmn:incoming>SequenceFlow_08wquce</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1be5nzy</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_1bq4kwa</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0np3v4s</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_1be5nzy" name="update" sourceRef="ExclusiveGateway_0zrnh1u" targetRef="update_bankruptcy">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression" language="JavaScript">var action= execution.getVariable("action");
action=='update';</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_08wquce" sourceRef="Task_0lmrup3" targetRef="ExclusiveGateway_0zrnh1u" />
    <bpmn:sequenceFlow id="SequenceFlow_1bq4kwa" name="discharge" sourceRef="ExclusiveGateway_0zrnh1u" targetRef="ServiceTask_Discharge_Bankruptcy">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression" language="JavaScript">var action= execution.getVariable("action");
action=='discharge';</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_0np3v4s" name="remove" sourceRef="ExclusiveGateway_0zrnh1u" targetRef="Task_0629yun">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression" language="JavaScript">var action= execution.getVariable("action");
action=='remove';</bpmn:conditionExpression>
    </bpmn:sequenceFlow>
    <bpmn:sequenceFlow id="SequenceFlow_1d5kp5u" sourceRef="Task_0629yun" targetRef="EndEvent_1mc81g0" />
    <bpmn:serviceTask id="Task_0629yun" name="remove bankruptcy" default="SequenceFlow_1d5kp5u">
      <bpmn:extensionElements>
        <camunda:connector>
          <camunda:inputOutput>
            <camunda:inputParameter name="url">
              <camunda:script scriptFormat="JavaScript">var adapterUrl = execution.getVariable('adapterUrl'); 
adapterUrl + '/unsecure/bankruptcy/remove';</camunda:script>
            </camunda:inputParameter>
            <camunda:inputParameter name="method">POST</camunda:inputParameter>
            <camunda:inputParameter name="headers">
              <camunda:map>
                <camunda:entry key="Accept">application/json</camunda:entry>
                <camunda:entry key="content-type">application/json</camunda:entry>
              </camunda:map>
            </camunda:inputParameter>
            <camunda:inputParameter name="payload">
              <camunda:script scriptFormat="JavaScript">var bankruptRemoveRequest=execution.getVariable("bankruptRemoveRequest");   
bankruptRemoveRequest.toString();</camunda:script>
            </camunda:inputParameter>
            <camunda:outputParameter name="isSystemAlertRemoved">
              <camunda:script scriptFormat="JavaScript">java.lang.System.out.println(response);

var removeRes = JSON.parse(response);
 var entityRes=removeRes.entity;
var isSystemAlertRemoved= entityRes.isSystemAlertRemoved;

java.lang.System.out.println(isSystemAlertRemoved);
isSystemAlertRemoved;</camunda:script>
            </camunda:outputParameter>
          </camunda:inputOutput>
          <camunda:connectorId>http-connector</camunda:connectorId>
        </camunda:connector>
      </bpmn:extensionElements>
      <bpmn:incoming>SequenceFlow_0np3v4s</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1d5kp5u</bpmn:outgoing>
    </bpmn:serviceTask>
    <bpmn:userTask id="UserTask_1pr5qfk" name="Ready For Assignment Queue" camunda:candidateGroups="rhAdministrator,rhAsst_Director,rhCSC_Manager,rhCSC_Asst_Manager,rhFin_Manager">
      <bpmn:documentation>Ready For Assignment Queue</bpmn:documentation>
      <bpmn:incoming>SequenceFlow_1i63awy</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1462y2m</bpmn:outgoing>
    </bpmn:userTask>
    <bpmn:sequenceFlow id="SequenceFlow_1462y2m" sourceRef="UserTask_1pr5qfk" targetRef="Task_0lmrup3" />
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="bankruptcy">
      <bpmndi:BPMNShape id="StartEvent_0ewcpto_di" bpmnElement="StartEvent_0ewcpto">
        <dc:Bounds x="118" y="789" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="202.583" y="829.196" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ServiceTask_0z5gg0w_di" bpmnElement="Task_0uo0f7r">
        <dc:Bounds x="458" y="767" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0x7dz3l_di" bpmnElement="ExclusiveGateway_0x7dz3l" isMarkerVisible="true">
        <dc:Bounds x="641" y="782" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="607.583" y="836" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0i1ljya_di" bpmnElement="SequenceFlow_0i1ljya">
        <di:waypoint x="558" y="807" />
        <di:waypoint x="641" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="554.5" y="786" width="90" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1i63awy_di" bpmnElement="SequenceFlow_1i63awy">
        <di:waypoint x="691" y="807" />
        <di:waypoint x="728" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="670" y="786" width="43" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="UserTask_014zr9t_di" bpmnElement="Task_0lmrup3">
        <dc:Bounds x="883" y="767" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1tlv432_di" bpmnElement="EndEvent_1tlv432">
        <dc:Bounds x="648" y="941" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="608" y="944.196" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_10gvnfv_di" bpmnElement="SequenceFlow_10gvnfv">
        <di:waypoint x="666" y="832" />
        <di:waypoint x="666" y="941" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="670" y="869" width="30" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_18rajel_di" bpmnElement="ServiceTask_Discharge_Bankruptcy">
        <dc:Bounds x="1191" y="767" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="EndEvent_1mc81g0_di" bpmnElement="EndEvent_1mc81g0">
        <dc:Bounds x="1367" y="789" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1322.0628227194493" y="829" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0pm94hw_di" bpmnElement="SequenceFlow_0pm94hw">
        <di:waypoint x="1291" y="807" />
        <di:waypoint x="1367" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1212.5" y="786" width="90" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0i6dk50_di" bpmnElement="SequenceFlow_0i6dk50">
        <di:waypoint x="933" y="623" />
        <di:waypoint x="933" y="767" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="796" y="547" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_08f0656_di" bpmnElement="update_bankruptcy">
        <dc:Bounds x="883" y="543" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1oosc2k_di" bpmnElement="SequenceFlow_1oosc2k">
        <di:waypoint x="154" y="807" />
        <di:waypoint x="255" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="173.5" y="782" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ScriptTask_1lhkh04_di" bpmnElement="Task_1x2r80z">
        <dc:Bounds x="255" y="767" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0zxydd7_di" bpmnElement="SequenceFlow_0zxydd7">
        <di:waypoint x="355" y="807" />
        <di:waypoint x="458" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="361.5" y="782" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ExclusiveGateway_0zrnh1u_di" bpmnElement="ExclusiveGateway_0zrnh1u" isMarkerVisible="true">
        <dc:Bounds x="1049" y="782" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1be5nzy_di" bpmnElement="SequenceFlow_1be5nzy">
        <di:waypoint x="1074" y="782" />
        <di:waypoint x="1074" y="583" />
        <di:waypoint x="983" y="583" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1032" y="685" width="34" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_08wquce_di" bpmnElement="SequenceFlow_08wquce">
        <di:waypoint x="983" y="807" />
        <di:waypoint x="1049" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="870.5" y="782" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1bq4kwa_di" bpmnElement="SequenceFlow_1bq4kwa">
        <di:waypoint x="1099" y="807" />
        <di:waypoint x="1191" y="807" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1117" y="783" width="48" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0np3v4s_di" bpmnElement="SequenceFlow_0np3v4s">
        <di:waypoint x="1074" y="832" />
        <di:waypoint x="1074" y="917" />
        <di:waypoint x="1191" y="917" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1098" y="900" width="37" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1d5kp5u_di" bpmnElement="SequenceFlow_1d5kp5u">
        <di:waypoint x="1291" y="917" />
        <di:waypoint x="1385" y="917" />
        <di:waypoint x="1385" y="825" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1221.5" y="892" width="90" height="20" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ServiceTask_1sgqr1o_di" bpmnElement="Task_0629yun">
        <dc:Bounds x="1191" y="877" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="UserTask_1pr5qfk_di" bpmnElement="UserTask_1pr5qfk">
        <dc:Bounds x="728" y="767" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1462y2m_di" bpmnElement="SequenceFlow_1462y2m">
        <di:waypoint x="828" y="807" />
        <di:waypoint x="883" y="807" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
